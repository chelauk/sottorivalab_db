{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://sottorivalab.local/schemas/patient_centric.schema.json",
  "title": "Patient-Centric Export",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "version": {
      "type": [
        "string",
        "null"
      ]
    },
    "updated_at": {
      "type": [
        "string",
        "null"
      ]
    },
    "patients": {
      "type": "object",
      "additionalProperties": {
        "$ref": "#/$defs/patient"
      }
    }
  },
  "required": [
    "patients"
  ],
  "$defs": {
    "patient": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "sex": {
          "type": [
            "string",
            "null"
          ]
        },
        "cases": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/$defs/case"
          }
        }
      },
      "required": [
        "sex",
        "cases"
      ]
    },
    "case": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "project_id": {
          "type": [
            "string",
            "null"
          ]
        },
        "samples": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/$defs/sample"
          }
        }
      },
      "required": [
        "project_id",
        "samples"
      ]
    },
    "sample": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "sample_meta": {
          "$ref": "#/$defs/sample_meta"
        },
        "analyses": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/$defs/analysis"
          }
        }
      },
      "required": [
        "sample_meta",
        "analyses"
      ]
    },
    "sample_meta": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "tissue_site": {
          "type": [
            "string",
            "null"
          ]
        },
        "sample_type": {
          "type": [
            "string",
            "null"
          ]
        },
        "phenotype": {
          "type": [
            "string",
            "null"
          ]
        },
        "case_control": {
          "type": [
            "string",
            "null"
          ]
        }
      },
      "required": [
        "tissue_site",
        "sample_type",
        "phenotype",
        "case_control"
      ]
    },
    "analysis": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "lab_method": {
          "type": [
            "string",
            "null"
          ]
        },
        "indexing": {
          "type": [
            "string",
            "null"
          ]
        },
        "technology": {
          "type": [
            "string",
            "null"
          ]
        },
        "raw_sequence": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/raw_sequence_item"
          }
        },
        "processed_data": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "bam": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/processed_file"
              }
            },
            "vcf": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/processed_file"
              }
            },
            "cna": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/processed_file"
              }
            },
            "qc": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/processed_file"
              }
            }
          },
          "required": [
            "bam",
            "vcf",
            "cna",
            "qc"
          ]
        }
      },
      "required": [
        "lab_method",
        "indexing",
        "technology",
        "raw_sequence",
        "processed_data"
      ]
    },
    "raw_sequence_item": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "gf_id": {
          "type": [
            "string",
            "null"
          ]
        },
        "fastqs": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/fastq_item"
          }
        }
      },
      "required": [
        "gf_id",
        "fastqs"
      ]
    },
    "fastq_item": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "gf_project": {
          "type": [
            "string",
            "null"
          ]
        },
        "run": {
          "type": [
            "string",
            "null"
          ]
        },
        "files": {
          "type": "object",
          "patternProperties": {
            "^L[0-9]{3}$": {
              "$ref": "#/$defs/lane_reads"
            }
          },
          "additionalProperties": false
        }
      },
      "required": [
        "gf_project",
        "run",
        "files"
      ]
    },
    "lane_reads": {
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "properties": {
        "R1": {
          "type": "string"
        },
        "R2": {
          "type": "string"
        },
        "R3": {
          "type": "string"
        }
      },
      "anyOf": [
        {
          "required": [
            "R1"
          ]
        },
        {
          "required": [
            "R2"
          ]
        },
        {
          "required": [
            "R3"
          ]
        }
      ]
    },
    "processed_file": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "file_path": {
          "type": "string"
        },
        "file_type": {
          "type": "string",
          "enum": [
            "bam",
            "vcf",
            "cna",
            "qc"
          ]
        },
        "pipeline_url": {
          "type": [
            "string",
            "null"
          ]
        },
        "metadata": {
          "$ref": "#/$defs/file_metadata"
        }
      },
      "required": [
        "file_path",
        "file_type",
        "pipeline_url",
        "metadata"
      ]
    },
    "file_metadata": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "size": {
          "type": [
            "string",
            "null"
          ]
        },
        "created": {
          "type": [
            "string",
            "null"
          ]
        },
        "epoch": {
          "type": "integer"
        }
      },
      "required": [
        "size",
        "created",
        "epoch"
      ]
    }
  }
}
